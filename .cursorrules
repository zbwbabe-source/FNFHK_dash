# 프로젝트 규칙 및 가이드라인

## README.md 필수 참고 시점

작업 시작 전에 반드시 README.md를 읽고 확인해야 하는 경우:

### 1. 사용자가 직접 요청할 때
- "리드미에 있는 규칙을 보면 좋겠어" → 즉시 README.md 읽기
- "README 확인해" → 즉시 README.md 읽기
- README 관련 언급이 있으면 무조건 확인

### 2. 데이터 계산 관련 작업 (⚠️ 매우 중요)
작업 시작 전 README.md의 계산 규칙을 **반드시** 확인:

- **할인율 계산**
  - 홍콩: `1 - (실판매출 / 택매출)`
  - 대만: `1 - (실판매출 * 1.05 / 택매출)`
  - 두 공식이 다르므로 반드시 README 확인 필수

- **YOY (Year-over-Year) 계산**
  - 전년 동월 기준 비교
  - 계산 방식: `현재 월 / 전년 동월 × 100`
  - TOP5 항목 계산 시 주의사항 확인

- **재고일수 계산**
  - 계산 공식: `(기말재고 / 누적 택매출) × 누적 일수`
  - 실판매출이 아닌 택매출 기준임을 확인

- **매출, 영업이익, 직접이익 등 모든 재무 지표 계산**
  - 포맷 규칙 확인 (정수 표시 vs 소수점 첫째자리)

### 3. 데이터 포맷 규칙이 필요한 작업
작업 전 README.md의 "데이터 표시 포맷 규칙" 섹션을 확인:

- **YOY**: 소수점 없이 정수로 표시 (예: 113%, 95%)
- **할인율, 증감 %p, 매출대비율**: 소수 첫째자리까지 표시 (`.toFixed(1)`)
- **증감 표시 기호**: 증가 `+`, 감소 `△`
- **색상 규칙**: 증가 녹색, 감소 빨간색

### 4. 대시보드 업데이트 작업
월별 데이터 추가, CSV 처리 등의 작업 시:

- **업데이트 순서 확인**
  - README.md의 "실적보고 대시보드 업데이트 순서" 섹션 참고
  - 경영실적 카드 10개 → 손익요약 → 그래프 → 매장별 현황 순서

- **2511 (25년 11월)부터 적용되는 새로운 업데이트 방식**
  - 각 대시보드를 하나씩 순차적으로 업데이트
  - CSV 전처리 우선 진행
  - 홍콩 → 대만 → 기타 순으로 진행

- **CSV 파일 경로 및 처리 규칙**
  - 대만 데이터: 부가세 제외 (÷ 1.05), 환율 적용
  - 홍콩 데이터: 부가세 없음, 환율 변환 불필요
  - **CSV 폴더 구조**: `Dashboard_Raw_Data/HKMC/{period}/`, `Dashboard_Raw_Data/TW/{period}/`
  - 예: `Dashboard_Raw_Data/HKMC/2511/HKMC_Inventory_2511.csv`

- **Period별 데이터 로드 (⚠️ 필수)**
  - 요약 페이지(`app/page.tsx`): Period 선택에 따라 동적으로 데이터 로드
  - CEO 대시보드: URL 파라미터 또는 props로 period 전달
  - 데이터 파일명 규칙: `{dashboard-type}-data-{period}.json`
  - 예: `hongkong-dashboard-data-2511.json`, `taiwan-pl-data-2510.json`
  - Fallback: Period별 파일 없으면 기본 파일 사용

### 5. 새로운 컴포넌트/카드 추가 작업
새로운 기능, 카드, 섹션을 추가할 때:

- 데이터 포맷 규칙 확인
- 프로젝트 구조 및 파일 위치 확인
- 기존 컴포넌트 스타일 가이드 확인

### 6. 프로젝트 구조 변경 작업
파일 이동, 이름 변경, 새 디렉토리 생성 시:

- README.md의 "프로젝트 구조" 섹션 확인
- 기존 네이밍 컨벤션 준수

### 7. 매장 효율성 계산 작업
점당매출, 매장별 분석 등:

- README.md의 "매장효율성 카드 계산 규칙" 섹션 필수 확인
- 온라인 제외, 매출 0인 매장 제외 등 규칙 준수

### 8. Period별 데이터 관리 (⚠️ 필수)
Period 선택 또는 데이터 로드 관련 작업 시:

- **요약 페이지**: `selectedPeriod` 상태로 동적 데이터 로드 (이미 구현됨)
- **CEO 대시보드**: `period` props 또는 URL 파라미터로 기간 전달
- **Python 스크립트**: 새로운 CSV 폴더 구조 사용
  - `Dashboard_Raw_Data/HKMC/{period}/`
  - `Dashboard_Raw_Data/TW/{period}/`
- **JSON 파일 생성**: Period별로 별도 파일 생성 (`-{period}.json`)

## 작업 시작 전 체크리스트

```
[ ] 이 작업이 위 8가지 카테고리에 해당하는가?
[ ] 해당한다면 README.md를 읽었는가?
[ ] 계산 공식, 포맷 규칙을 확인했는가?
[ ] 기존 코드에 하드코딩된 잘못된 값이 없는가?
[ ] Period별 데이터를 올바르게 로드하고 있는가?
```

## 중요 원칙

1. **README.md는 단순 참고 문서가 아닌 필수 규칙서입니다**
2. **"아마도 이렇게 하면 되겠지" 추측 금지 → README 확인 필수**
3. **계산 관련 작업은 무조건 README부터 읽기**
4. **사용자에게 "이거 몰라?????????????"라는 피드백을 받지 않도록 사전 확인**

## 추가 참고 문서

- **DASHBOARD_UPDATE_GUIDE.md**: 상세한 업데이트 절차 및 검증 가이드
- **GIT-사용법.md**: Git 워크플로우 및 커밋 규칙
- **PYTHON_SETUP_GUIDE.md**: Python 환경 설정 및 스크립트 실행 가이드
